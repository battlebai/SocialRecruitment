@model IEnumerable<Langben.DAL.FileUploader>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/Personal.cshtml";
}



<div class="col-md-9 column">
    <ul class="breadcrumb">
        <li><a>首页</a> </li>
        <li class="active"> 上传文件</li>
    </ul>
   
</div>
<script type="text/javascript">

    $(function () {

        //学校
        GetSysField("#ddlSchoolArea", "DegreeSchool", "SchoolArea");
        $("#ddlSchoolArea").change(function () { GetSysFieldByParent("#ddlSchoolName", "#ddlSchoolArea", "SchoolName", "SchoolArea"); });
        //专业
        GetSysField("#ddlProfessionalType1", "DegreeSchool", "ProfessionalType1");
        $("#ddlProfessionalType1").change(function () { GetSysFieldByParent("#ddlProfessionalType2", "#ddlProfessionalType1", "ProfessionalType2", "ProfessionalType1"); });

        //学历
        GetSysField("#ddlEducation", "DegreeSchool", "Education");

        //学位
        GetSysField("#ddlDegree", "DegreeSchool", "Degree");
       

    });

    //添加
    function AddShow() {
        $("#hideID").val("");
        $("#txtBeginDate").val("");
        $("#txtEndDate").val("");       
        $("#cbIsNow").attr("checked", false);     
        $("#ddlSchoolArea").get(0).selectedIndex = 0;
        $("#ddlSchoolName").get(0).selectedIndex = 0;
        $("#ddlProfessionalType1").get(0).selectedIndex = 0;
        $("#ddlProfessionalType2").get(0).selectedIndex = 0;
        $("#ddlEducation").get(0).selectedIndex = 0;
        $("#ddlDegree").get(0).selectedIndex = 0;        
        $('#divEdit').show();
        $('#divAddOp').show();
        $('#divEditOp').hide();        
        $('#divNoOp').hide();
        
        
    }
    //数据检验
    function CheckData()
    {
        var BeginDate = $("#txtBeginDate").val();
        var EndDate = $("#txtEndDate").val();
        var IsNow = ($("#cbIsNow").attr("checked"));
        var Message = "";
        if(trimStr(BeginDate)=="")
        {
            Message = "开始日期不能为空\n\r";
        }
        // checkbox "undefined" "checked"
        if (trimStr(EndDate) == "" && IsNow == "undefined") {
            Message = "结束日期不能为空\n\r";
        }
        if(Message!="")
        {
            alert(Message);
            return false;
        }
        return true;
    }
    //保存提交
    function AddSubmint(Op)
    {
        //验证数据
        if(CheckData())
        {
            var Id = $("#hideID").val();
            var BeginDate = $("#txtBeginDate").val();
            var EndDate = $("#txtEndDate").val();           
            var IsNow = ($("#cbIsNow").attr("checked"));
            // checkbox "undefined" "checked"
            if (IsNow == "checked")
            {
                EndDate = "";
                IsNow = "Y";
            }
            else
            {
                IsNow = "N";
            }
            
            var SchoolArea = $("#ddlSchoolArea").val();
            var SchoolName = $("#ddlSchoolName").val();
            var ProfessionalType1 = $("#ddlProfessionalType1").val();

            var ProfessionalType2 = $("#ddlProfessionalType2").val();
            var Education = $("#ddlEducation").val();
            var Degree = $("#ddlDegree").val();            
            //var Model=  jQuery.parseJSON('{"'BeginDate": "'+BeginDate+'", "EndDate": "'+EndDate+'", "IsNow": "'+IsNow+'", "SchoolArea": "'+SchoolArea+'", "SchoolName": "'+SchoolName+'", "ProfessionalType1": "'+ProfessionalType1+'", "ProfessionalType2": "'+ProfessionalType2+'", "Education": "'+Education+'", "Degree": "'+Degree+'" }');
            var Model = '{ "Id":"'+Id+'","BeginDate": "' + BeginDate + '", "EndDate": "' + EndDate + '", "IsNow": "' + IsNow + '", "SchoolArea": "' + SchoolArea + '", "SchoolName": "' + SchoolName + '", "ProfessionalType1": "' + ProfessionalType1 + '", "ProfessionalType2": "' + ProfessionalType2 + '", "Education": "' + Education + '", "Degree": "' + Degree + '" }';


            $.ajax({
                url: "/DegreeSchool/CreateSave",
                type: "post",
                dataType: "json",
                //data: { "BeginDate": BeginDate, "EndDate": EndDate, "IsNow": IsNow, "SchoolArea": SchoolArea, "SchoolName": SchoolName, "ProfessionalType1": ProfessionalType1, "ProfessionalType2": ProfessionalType2, "Education": Education, "Degree": Degree },
                data: { "Model": Model },
                success: function (data) {
                    if (data.Code == 1) {//成功
                        alert("操作成功");
                        if(Op=="Next")
                        {
                            window.location.href ="/LanguageCompetence/Index";
                        }
                    }
                    else {//失败
                        alert(data.Message);
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {                   
                    return false;
                }
            });
        }
    }
    //修改显示
    function EditShow(Id) {
        $("#hideID").val(Id);
        $.ajax({
            url: "/DegreeSchool/GetById",
            type: "post",
            dataType: "json",
            data: { "Id": Id },
            success: function (data) {
                if (data !=null) {//成功
                    $("#txtBeginDate").val(jsonDateFormat(data.BeginDate));
                    $("#txtEndDate").val(jsonDateFormat(data.EndDate));
                    if (data.IsNow=="Y")
                    {
                        $("#cbIsNow").attr("checked", true);
                    }
                    else
                    {
                        $("#cbIsNow").attr("checked", false);
                    }                   
                    $("#ddlSchoolArea").val(data.SchoolArea).change();
                    $("#ddlSchoolName").val(data.SchoolName);
                    $("#ddlProfessionalType1").val(data.ProfessionalType1).change();
                    $("#ddlProfessionalType2").val(data.ProfessionalType2);
                    $("#ddlEducation").val(data.Education);
                    $("#ddlDegree").val(data.Degree);
                    $("#hideResumeId").val(data.ResumeId);
                    $("#hideSort").val(data.Sort);
                    $("#hideCreateTime").val(data.CreateTime);
                    $("#hideCreatePerson").val(data.CreatePerson);
                    $('#divEdit').show();
                    $('#divAddOp').hide();
                    $('#divEditOp').show();
                    $('#divNoOp').hide();
                }
                else {//失败
                    alert("未获取到数据");
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                return false;
            }
        });

    }
    //删除
    function Delete(Id) {
    }

</script>
